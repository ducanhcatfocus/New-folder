<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Code Display with CodeMirror</title>
    <link rel="stylesheet" href="/publics/codemirror/lib/codemirror.css" />
    <link rel="stylesheet" href="/publics/codemirror/theme/3024-night.css" />
    <link rel="stylesheet" href="/publics/codemirror/theme/dracula.css" />

    <style>
      #code-container {
        width: 100%;
        height: 800px;
        overflow: auto;
      }
    </style>
  </head>
  <body>
    <h2 class="page-title">Code Dictionary</h2>
<a class="edit" href="/home">home</a>

    <h2 class="page-title"><%= code.titleProblem %></h2>
    <button onclick="changeTheme()">Change Theme</button>
    <button onclick="myFunction()">Copy Code</button>
    <textarea id="code-container"><%= code.codeContent %></textarea>

    <script src="/publics/codemirror/lib/codemirror.js"></script>
    <script src="/publics/codemirror/mode/javascript/javascript.js"></script>
    <script src="/publics/codemirror/mode/clike/clike.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const code = `<%= code %>`;

        var editor = CodeMirror.fromTextArea(
          document.getElementById("code-container"),
          {
            value: code,
            mode: "text/x-csharp",
            lineNumbers: true,
            theme: "3024-night",
            decodeEntities: false,
          }
        );

        editor.setSize("100%", "100%")
        let count = 0;

        window.changeTheme = function () {
          count++;
          if (count > 2) count = 0;

          switch (count) {
            case 0:
              editor.setOption("theme", "3024-night");
              break;
            case 1:
              editor.setOption("theme", "dracula");
              break;
            case 2:
              editor.setOption("theme", "default");
              break;
            default:
              editor.setOption("theme", "3024-night");
          }
        };

        window.myFunction = function () {
          var copyText = document.getElementById("code-container");
          copyText.select();
          copyText.setSelectionRange(0, 99999);
          navigator.clipboard.writeText(copyText.value);
          alert("Copied");
        };
      });
    </script>
  </body>
</html>
